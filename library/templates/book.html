{% extends "base.html" %}

{% block title %} Knyga {% endblock %}

{% block title_h1 %}
<h1>Knyga</h1>
{% endblock %}

{% block content %}
{% load static %}

{% if book.cover %}
<img class="card-img-top mb-3" style="max-width: 20%" src="{{ book.cover.url }}">
{% else %}
    <img class="card-img-top mb-3" style="max-width: 20%" src="{% static 'img/no-image.jpg' %}">
{% endif %}

<p>  Pavadinimas: <strong>{{book.title}}</strong> </p>
<p>  Autorius: <strong>{{book.author}}</strong> </p>
<p>  ISBN: <strong>{{book.isbn}}</strong> </p>
<p>  Žanras <strong>{{book.display_genre}}</strong> </p>
<p>  {{book.summary}} </p>


{% if book.reviews.all %}
<h2>Atsiliepimai:</h2>
<br/>
{% for review in book.reviews.all %}
{% if review.reviewer.photo %}
    <img src="{{ review.reviewer.photo.url }}" class="rounded-circle" style="width: 30px">
    {% endif %}
<p><strong>{{ review.reviewer }}</strong>, <em>{{ review.date_created }}</em></p>
<p>{{ review.content }}</p>
<hr>
{% endfor %}
{% else %}
<p>Komentarų nėra</p>
{% endif %}

{% if user.is_authenticated %}
<h2>Palikite atsiliepimą</h2>
<form method="post" class="mb-2">
    {% csrf_token %}
    {% load crispy_forms_tags %}
    {{ form | crispy }}
    <button type="submit" class="btn btn-primary">Paskelbti</button>
</form>
{% endif %}


<h3>Kopijos:</h3>
{% if book.instances.all %}
    {% for copy in book.instances.all %}
    <hr>
<p class="{% if copy.status == 'a' %}text-success{% elif copy.status == 't' %}text-danger{% elif copy.status == 'r' %}text-warning{% endif %}">
 <strong>{{ copy.get_status_display }}</strong></p>
    {% if copy.due_back %}
    <p><strong>Bus gražinta: </strong>{{ copy.due_back }}</p>
    {% endif %}
    <small class="text-muted"><strong>ID: </strong>{{ copy.uuid }}</small>
    {% endfor %}
    {% else %}
    <p>Šios knygos kopijų neturime</p>
    {% endif %}

{% endblock %}
